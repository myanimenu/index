<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>myanimenu</title>
  <!-- Placeholder para favicon -->
  <link rel="shortcut icon" href="myanimenu_pfp.png" type="image/x-icon">

  <!-- React & ReactDOM -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <!-- Babel -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Phosphor Icons -->
  <script src="https://unpkg.com/@phosphor-icons/web"></script>
  <!-- Lucide Icons -->
  <script src="https://unpkg.com/lucide@latest"></script>

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">

  <style>
    body {
      font-family: 'Inter', sans-serif;
      background-color: #0a0a0a;
      color: #f8fafc;
      margin: 0;
      overflow-x: hidden;
    }

    /* --- UI --- */
    .config-modal {
      background: linear-gradient(135deg, #121212 0%, #0d0d0d 100%);
      border: 1px solid #2a2a2a;
      box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.9);
      animation: modalEnter 0.4s cubic-bezier(0.16, 1, 0.3, 1) forwards;
      transform-origin: center center;
      position: relative;
    }

    @keyframes modalEnter {
      from { opacity: 0; transform: scale(0.96) translateY(10px); }
      to { opacity: 1; transform: scale(1) translateY(0); }
    }

    /* --- Links (Novo Visual OTIMIZADO) --- */
    .card-hover {
      transition: transform 0.4s cubic-bezier(0.25, 0.8, 0.25, 1), 
                  box-shadow 0.4s cubic-bezier(0.25, 0.8, 0.25, 1), 
                  border-color 0.3s ease,
                  background 0.3s ease;
      will-change: transform; 
      border: 1px solid rgba(255, 255, 255, 0.05);
      background: linear-gradient(145deg, #121212 0%, #0c0c0c 100%);
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    }

    .card-hover:hover {
      transform: translateY(-6px);
      box-shadow: 0 20px 30px -5px rgba(0, 0, 0, 0.4), 0 10px 10px -5px rgba(0, 0, 0, 0.2);
    }

    /* Otimização dos ícones dentro do card */
    .card-hover .icon-transition {
        transition: opacity 0.5s ease, transform 0.5s cubic-bezier(0.2, 0.8, 0.2, 1);
    }

    /* Animação de troca de sublista */
    .content-swap-enter {
        animation: fadeScaleIn 0.4s cubic-bezier(0.2, 0.8, 0.2, 1);
    }

    @keyframes fadeScaleIn {
        from { opacity: 0; transform: scale(0.98); }
        to { opacity: 1; transform: scale(1); }
    }

    /* Scrollbar */
    ::-webkit-scrollbar {
      width: 6px;
      height: 6px;
    }

    ::-webkit-scrollbar-track {
      background: #0f0f0f;
    }

    ::-webkit-scrollbar-thumb {
      background: #333;
      border-radius: 3px;
    }

    .fab-active-press:active {
      transform: scale(0.92) !important;
      transition: transform 0.1s ease-out;
    }

    .custom-scrollbar::-webkit-scrollbar {
      width: 5px;
      height: 5px;
    }

    .custom-scrollbar::-webkit-scrollbar-track {
      background: transparent;
    }

    .custom-scrollbar::-webkit-scrollbar-thumb {
      background: #222;
      border-radius: 10px;
    }

    .horizontal-scrollbar::-webkit-scrollbar {
      height: 7px;
    }

    /* Transição suave para o painel de configurações extras */
    .advanced-settings-enter {
      max-height: 0;
      opacity: 0;
      overflow: hidden;
      transition: max-height 0.5s cubic-bezier(0.2, 0.8, 0.2, 1), opacity 0.4s ease;
    }

    .advanced-settings-enter.show {
      max-height: 500px;
      opacity: 1;
    }

    /* Animação para os botões laterais */
    .side-action-btn {
        animation: slideInRight 0.4s cubic-bezier(0.16, 1, 0.3, 1) forwards;
        opacity: 0;
        transform: translateX(-10px);
    }

    @keyframes slideInRight {
        to { opacity: 1; transform: translateX(0); }
    }
  </style>

  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            ap: {
              accent: '#333333',
              text: '#ffffff',
              muted: '#9ca3af'
            }
          }
        }
      }
    }
  </script>
</head>

<body>

  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect, useCallback, memo, useMemo } = React;

    // --- UTILS & HELPERS ---
    const generateSafeId = () => {
      if (window.crypto && window.crypto.randomUUID) {
        return window.crypto.randomUUID();
      }
      return Date.now().toString(36) + Math.random().toString(36).substr(2);
    };

    // --- CONFIGURAÇÃO PADRÃO ---
    const DEFAULT_CONFIG = [
      { 
        id: '1', 
        title: "watched-animes", 
        subtitle: "version-x", 
        url: "#", 
        icon: "ph-eye", 
        color: "bg-green-600", 
        visible: true, 
        enabled: true, 
        openNewTab: true,
        activeMode: 'main', 
        sublist: null 
      },
      { id: '2', title: "seasonalist", subtitle: "version-ii", url: "#", icon: "ph-clock", color: "bg-red-600", visible: true, enabled: true, openNewTab: true, activeMode: 'main', sublist: null },
      { id: '3', title: "myhtmlist", subtitle: "version-viii", url: "#", icon: "ph-file-html", color: "bg-pink-600", visible: true, enabled: true, openNewTab: true, activeMode: 'main', sublist: null },
      { id: '5', title: "my-list", subtitle: "version-v", url: "#", icon: "ph-star", color: "random", visible: true, enabled: true, openNewTab: true, activeMode: 'main', sublist: null },
      { id: '6', title: "anilist", subtitle: "tracking", url: "https://anilist.co", icon: "ph-list-magnifying-glass", color: "bg-blue-600", visible: true, enabled: true, openNewTab: true, activeMode: 'main', sublist: null },
      { id: '7', title: "mangadex", subtitle: "reader", url: "https://mangadex.org", icon: "ph-book-open", color: "bg-orange-600", visible: true, enabled: true, openNewTab: true, activeMode: 'main', sublist: null },
    ];

    const AVAILABLE_COLORS = [
      "bg-blue-600", "bg-sky-600", "bg-cyan-600", "bg-teal-600", "bg-green-600", 
      "bg-yellow-500", "bg-orange-600", "bg-red-600", "bg-rose-600", "bg-pink-600", 
      "bg-fuchsia-600", "bg-purple-600", "bg-white", "random"
    ];
      
    const RANDOM_POOL = [
      "bg-blue-600", "bg-sky-600", "bg-cyan-600", "bg-teal-600", "bg-green-600", 
      "bg-yellow-500", "bg-orange-600", "bg-red-600", "bg-rose-600", "bg-pink-600", 
      "bg-fuchsia-600", "bg-purple-600", "bg-indigo-500"
    ];

    // --- HOOKS PERSONALIZADOS ---

    const useClock = () => {
      const [time, setTime] = useState(new Date());
      const [greeting, setGreeting] = useState("");
      const [formattedDate, setFormattedDate] = useState("");

      useEffect(() => {
        const update = () => {
          const now = new Date();
          setTime(now);
          
          const hour = now.getHours();
          if (hour >= 5 && hour < 12) setGreeting("BOM DIA");
          else if (hour >= 12 && hour < 18) setGreeting("BOA TARDE");
          else setGreeting("BOA NOITE");

          setFormattedDate(now.toLocaleDateString('pt-BR', { weekday: 'long', day: 'numeric', month: 'long' }).replace(/^\w/, (c) => c.toUpperCase()));
        };
        
        update();
        const timer = setInterval(update, 1000);
        return () => clearInterval(timer);
      }, []);

      return { time, greeting, formattedDate };
    };

    // --- SISTEMA DE SALVAMENTO ---
    const usePersistentData = (key, initialValue) => {
      const [data, setData] = useState(() => {
        try {
          const saved = localStorage.getItem(key);
          if (saved) {
            const parsed = JSON.parse(saved);
            if (Array.isArray(parsed)) {
                return parsed.map(item => ({
                    ...item,
                    openNewTab: item.openNewTab !== undefined ? item.openNewTab : true,
                    enabled: item.enabled !== undefined ? item.enabled : true,
                    visible: item.visible !== undefined ? item.visible : true,
                    activeMode: item.activeMode || 'main', 
                    sublist: item.sublist || null, 
                    id: item.id || generateSafeId()
                }));
            }
          }
        } catch (error) {
          console.error("Erro ao ler localStorage:", error);
        }
        return initialValue;
      });

      useEffect(() => {
        try {
          localStorage.setItem(key, JSON.stringify(data));
        } catch (error) {
          console.error("Falha Crítica: Não foi possível salvar no armazenamento local.", error);
        }
      }, [data, key]);

      return [data, setData, true];
    };

    // --- COMPONENTES ---

    const LucideIcon = memo(({ name, size = 24, className = "" }) => {
      useEffect(() => {
        if (window.lucide) window.lucide.createIcons();
      }, [name, className]);
      return <i data-lucide={name} className={className} style={{ width: size, height: size }}></i>;
    });

    const LinkCardSite2 = memo(({ data, onToggleMode, isPreview = false }) => {
      const isSublistActive = data.activeMode === 'sub' && data.sublist;
      const currentContent = isSublistActive ? data.sublist : data;

      const title = currentContent.title || data.title;
      const subtitle = currentContent.subtitle || data.subtitle;
      const url = currentContent.url || data.url;
      const icon = currentContent.icon || data.icon;
      const color = currentContent.color || data.color;

      const [displayColor] = useState(() => {
          if (color === 'random') {
            return RANDOM_POOL[Math.floor(Math.random() * RANDOM_POOL.length)];
          }
          return color;
      });

      const finalColor = color === 'random' ? displayColor : color;

      const textColorClass = useMemo(() => 
        finalColor 
          ? finalColor.replace('bg-', 'text-').replace('600', '400').replace('500', '400') 
          : 'text-gray-400',
      [finalColor]);
      
      const isDisabled = !currentContent.enabled && !isPreview;
      const WrapperTag = isDisabled ? 'div' : 'a';
      
      const shouldOpenNewTab = currentContent.openNewTab !== false;

      const handleCardClick = (e) => {
        if (isDisabled) {
            e.preventDefault();
            return;
        }
        if (e.target.closest('.toggle-btn')) {
            e.preventDefault();
            return;
        }
      };

      const WrapperProps = isDisabled ? {
        className: `group relative w-full h-36 rounded-2xl p-6 overflow-hidden flex flex-col justify-between border border-[#222] bg-[#0c0c0c] opacity-50 cursor-not-allowed`,
      } : {
        href: url,
        target: shouldOpenNewTab ? "_blank" : "_self",
        rel: shouldOpenNewTab ? "noopener noreferrer" : undefined,
        onClick: handleCardClick,
        className: `group relative w-full h-36 rounded-2xl p-6 overflow-hidden flex flex-col justify-between card-hover cursor-pointer`,
      };

      return (
        <WrapperTag {...WrapperProps}>
          {/* Fundo colorido */}
          <div key={finalColor} className={`absolute inset-0 opacity-0 ${!isDisabled && 'group-hover:opacity-5'} transition-opacity duration-300 ease-in-out ${finalColor} mix-blend-screen will-change-opacity`}></div>
          
          {/* Ícone de fundo */}
          <div className={`absolute -right-6 -bottom-8 opacity-[0.03] ${!isDisabled && 'group-hover:opacity-10 group-hover:scale-110 group-hover:-rotate-12'} icon-transition z-0`}>
             <i className={`ph-fill ${icon} text-[8rem] ${textColorClass}`}></i>
          </div>

          {/* Botão de Toggle Sublista */}
          {data.sublist && (
             <div className="absolute top-4 right-4 z-30 toggle-btn">
                <button
                    onClick={(e) => {
                        e.preventDefault();
                        e.stopPropagation();
                        onToggleMode(data.id);
                    }}
                    className={`
                        w-8 h-8 rounded-full flex items-center justify-center 
                        transition-all duration-300 backdrop-blur-md border shadow-lg 
                        hover:scale-110 active:scale-90
                        ${isSublistActive 
                            ? 'bg-indigo-500/20 border-indigo-500/30 text-indigo-300 shadow-indigo-900/20' 
                            : 'bg-white/5 border-white/10 text-gray-400 hover:text-white hover:bg-white/10'}
                    `}
                >
                    <i className={`ph-bold ph-arrows-left-right text-sm transition-transform duration-500 ${isSublistActive ? 'rotate-180' : ''}`}></i>
                </button>
             </div>
          )}

          <div className="relative z-10 flex flex-col h-full justify-between content-swap-enter" key={isSublistActive ? 'sub' : 'main'}>
            <div>
              <div className="mb-2 flex items-center gap-2">
                <span className={`text-[10px] font-bold uppercase tracking-[0.2em] text-gray-500 ${!isDisabled && 'group-hover:text-gray-400'} transition-colors duration-300`}>
                  {subtitle}
                </span>
              </div>
              <h3 className={`font-bold text-2xl md:text-3xl text-white tracking-tight leading-none ${!isDisabled && 'group-hover:text-white'} transition-colors duration-300 truncate pr-8`}>
                {title}
              </h3>
            </div>
            {/* Barra de progresso visual */}
            <div className={`w-8 h-1 rounded-full ${finalColor} opacity-20 ${!isDisabled && 'group-hover:w-16 group-hover:opacity-80'} transition-all duration-300 cubic-bezier(0.2, 0.8, 0.2, 1)`}></div>
          </div>
        </WrapperTag>
      );
    });

    const ToggleSwitch = memo(({ checked, onChange }) => (
      <div 
        onClick={() => onChange(!checked)}
        className={`w-9 h-5 rounded-full relative cursor-pointer transition-colors duration-300 ease-in-out border border-white/5 ${checked ? 'bg-indigo-600' : 'bg-zinc-700'}`}
      >
        <div className={`absolute top-[2px] w-[14px] h-[14px] bg-white rounded-full shadow-md transition-all duration-300 cubic-bezier(0.4, 0, 0.2, 1) ${checked ? 'left-[18px]' : 'left-[3px]'}`}></div>
      </div>
    ));

    // --- APP PRINCIPAL ---
    const App = () => {
      const [items, setItems, isDataLoaded] = usePersistentData('myanimenu_v10_fixed', DEFAULT_CONFIG);
      const { time, greeting, formattedDate } = useClock();

      const [isConfigOpen, setIsConfigOpen] = useState(false);
      // Removido estado isFabOpen pois não usamos mais o toggle
      
      const [activeTabId, setActiveTabId] = useState(null);
      const [tempItems, setTempItems] = useState([]);
      const [showAdvancedSettings, setShowAdvancedSettings] = useState(false);
      const [showDeleteConfirm, setShowDeleteConfirm] = useState(false);
      const [showSublistDeleteConfirm, setShowSublistDeleteConfirm] = useState(false);
      const [showImportConfirm, setShowImportConfirm] = useState(false);
      const [showExportConfirm, setShowExportConfirm] = useState(false);
      
      const [draggedId, setDraggedId] = useState(null);
      const [editingSublist, setEditingSublist] = useState(false);

      const visibleItems = useMemo(() => items.filter(item => item.visible), [items]);
      
      useEffect(() => {
        document.body.style.overflowY = 'auto';
      }, [visibleItems.length]);

      const openConfig = useCallback(() => {
        setTempItems(JSON.parse(JSON.stringify(items)));
        
        if (items.length > 0) {
            const exists = activeTabId && items.find(i => i.id === activeTabId);
            if (!exists) setActiveTabId(items[0].id);
        }
        
        setShowAdvancedSettings(false);
        setIsConfigOpen(true);
        setShowDeleteConfirm(false);
        setShowSublistDeleteConfirm(false);
        setShowImportConfirm(false); 
        setShowExportConfirm(false);
        setEditingSublist(false);
      }, [items, activeTabId]);

      const saveConfig = useCallback(() => {
        setItems(tempItems);
        setIsConfigOpen(false);
      }, [tempItems, setItems]);

      const executeExport = useCallback(() => {
        const dataStr = JSON.stringify(tempItems, null, 2);
        const blob = new Blob([dataStr], { type: "application/json" });
        const url = URL.createObjectURL(blob);
        
        const link = document.createElement('a');
        link.href = url;
        const date = new Date().toISOString().slice(0, 10);
        link.download = `myanimenu-backup-${date}.json`;
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        setShowExportConfirm(false);
      }, [tempItems]);

      const handleImport = useCallback((event) => {
        const file = event.target.files[0];
        if (!file) return;

        const reader = new FileReader();
        reader.onload = (e) => {
            try {
                const importedData = JSON.parse(e.target.result);
                if (Array.isArray(importedData)) {
                    setTempItems(importedData);
                    
                    if (importedData.length > 0) {
                        setActiveTabId(importedData[0].id);
                    }
                    setShowImportConfirm(true);
                } else {
                    alert("O arquivo selecionado não é válido.");
                }
            } catch (error) {
                console.error("Erro ao importar:", error);
                alert("Erro ao ler o arquivo de configuração.");
            }
        };
        reader.readAsText(file);
        event.target.value = '';
      }, []);

      const addNewLink = useCallback(() => {
        const colorPool = ["bg-red-600", "bg-orange-600", "bg-green-600", "bg-cyan-600", "bg-pink-600", "random"];
        const newItem = {
          id: generateSafeId(),
          title: "Novo Link", 
          subtitle: "Descrição", 
          url: "https://google.com",
          icon: "ph-link", 
          color: colorPool[Math.floor(Math.random() * colorPool.length)], 
          visible: true, 
          enabled: true,
          openNewTab: true,
          activeMode: 'main',
          sublist: null
        };
        
        if (isConfigOpen) {
            setTempItems(prev => [...prev, newItem]);
            setActiveTabId(newItem.id);
        } else {
            const newItems = [...items, newItem];
            setItems(newItems);
            setTempItems(newItems);
            setActiveTabId(newItem.id);
            setShowAdvancedSettings(false);
            setIsConfigOpen(true);
            setEditingSublist(false);
        }

      }, [items, isConfigOpen, setItems]);

      const updateItem = useCallback((id, field, value) => {
        setTempItems(prev => prev.map(item => {
            if (item.id !== id) return item;

            if (editingSublist && item.sublist) {
                return {
                    ...item,
                    sublist: {
                        ...item.sublist,
                        [field]: value
                    }
                };
            }
            return { ...item, [field]: value };
        }));
      }, [editingSublist]);

      const toggleSublistCreation = useCallback((id) => {
        setTempItems(prev => prev.map(item => {
            if (item.id !== id) return item;

            if (item.sublist) {
                setEditingSublist(prevEdit => !prevEdit);
                return item;
            }

            setEditingSublist(true);
            const colorPool = ["bg-red-600", "bg-orange-600", "bg-green-600", "bg-cyan-600", "bg-pink-600", "random"];
            return {
                ...item,
                sublist: {
                    title: "Novo Link",
                    subtitle: "Descrição",
                    url: item.url,
                    icon: "ph-list-star",
                    color: colorPool[Math.floor(Math.random() * colorPool.length)],
                    enabled: true,
                    openNewTab: true
                }
            };
        }));
      }, []);

      const deleteItem = useCallback((idToDelete) => {
        if (tempItems.length <= 1) {
            alert("Você precisa ter pelo menos um link.");
            return;
        }
        
        const newTemp = tempItems.filter(item => item.id !== idToDelete);
        setTempItems(newTemp);
        
        if (activeTabId === idToDelete) {
          setActiveTabId(newTemp[0]?.id || null);
          setEditingSublist(false);
        }
      }, [tempItems, activeTabId]);

      const deleteSublist = useCallback((idToModify) => {
        setTempItems(prev => prev.map(item => {
            if (item.id !== idToModify) return item;
            
            return {
                ...item,
                sublist: null,
                activeMode: 'main'
            };
        }));
        setEditingSublist(false);
      }, []);

      const moveItem = useCallback((fromId, toId) => {
        if (fromId === toId) return;
        setTempItems(prev => {
          const newArr = [...prev];
          const fromIndex = newArr.findIndex(i => i.id === fromId);
          const toIndex = newArr.findIndex(i => i.id === toId);
          
          if (fromIndex === -1 || toIndex === -1) return prev;
          
          const [moved] = newArr.splice(fromIndex, 1);
          newArr.splice(toIndex, 0, moved);
          return newArr;
        });
      }, []);

      const toggleCardMode = useCallback((id) => {
        setItems(prev => prev.map(item => {
            if (item.id !== id) return item;
            const newMode = item.activeMode === 'sub' ? 'main' : 'sub';
            return { ...item, activeMode: newMode };
        }));
      }, [setItems]);

      const isNight = greeting === "BOA NOITE";
      const greetingGradient = isNight 
          ? "from-indigo-300 via-purple-300 to-indigo-300" 
          : "from-yellow-200 via-orange-200 to-yellow-200";

      const activeItem = useMemo(() => 
          tempItems.find(i => i.id === activeTabId) || tempItems[0], 
      [tempItems, activeTabId]);

      const editingData = useMemo(() => {
          if (!activeItem) return {};
          if (editingSublist && activeItem.sublist) return activeItem.sublist;
          return activeItem;
      }, [activeItem, editingSublist]);

      useEffect(() => {
          if (activeItem && editingSublist && !activeItem.sublist) {
              setEditingSublist(false);
          }
      }, [activeTabId, activeItem]);

      // --- Helper para botão sublista (MODIFICADO - SEM BORDA COLORIDA) ---
      const getSublistButtonContent = () => {
        // Removido hover:border-indigo-500/20
        const commonStyle = "text-gray-500 hover:text-indigo-400 hover:bg-indigo-500/10 border-transparent";

        if (editingSublist) {
            return { icon: 'ph-arrow-u-up-left', text: 'Link Normal', color: commonStyle };
        }
        if (activeItem && activeItem.sublist) {
            return { icon: 'ph-pencil-simple', text: 'Editar Sublink', color: commonStyle };
        }
        return { icon: 'ph-list-plus', text: 'Criar Sublink', color: commonStyle };
      };

      const sublistBtn = getSublistButtonContent();

      if (!isDataLoaded) return null;

      return (
        <div className="min-h-screen flex flex-col items-center relative overflow-x-hidden pt-20 pb-10">
          <div className="fixed top-0 left-0 w-full h-full -z-10 bg-[#0a0a0a]">
          </div>

        {/* BOTÃO FIXO DE CONFIGURAÇÃO (VISUAL MELHORADO) */}
        <div className="fixed bottom-4 right-4 z-50">
          <button 
            onClick={openConfig}
            className="group w-12 h-12 flex items-center justify-center rounded-full transition-all duration-300 transform border border-white/5 fab-active-press translate-y-0 opacity-100 scale-100 bg-white/5 text-white/30 hover:text-white hover:bg-white/10 hover:scale-110"
          >
            <svg viewBox="0 0 24 24" fill="currentColor" className="w-7 h-7 transition-all duration-500 ease-in-out group-hover:scale-110 group-hover:rotate-90">
              <path d="M19.43 12.98c.04-.32.07-.64.07-.98 0-.34-.03-.66-.07-.98l2.11-1.65c.19-.15.24-.42.12-.64l-2-3.46c-.12-.22-.39-.3-.61-.22l-2.49 1c-.52-.4-1.08-.73-1.69-.98l-.38-2.65c-.03-.24-.24-.42-.49-.42h-4c-.25 0-.46.18-.49.42l.38 2.65c-.61.25-1.17.59-1.69.98l-2.49-1c-.23-.09-.49 0-.61.22l-2 3.46c-.13.22-.07.49.12.64l2.11 1.65c-.04.32-.07.65-.07.98 0 .33.03.66.07.98l-2.11 1.65c-.19.15-.24.42-.12.64l2 3.46c.12.22.39.3.61.22l2.49-1c.52.4 1.08.73 1.69.98l.38 2.65c.03.24.24.42.49.42h4c.25 0 .46-.18.49-.42l.38-2.65c.61-.25 1.17-.59 1.69-.98l2.49 1c.23.09.49 0 .61-.22l2-3.46c.12-.22.07-.49-.12-.64l-2.11-1.65zM12 15.5c-1.93 0-3.5-1.57-3.5-3.5s1.57-3.5 3.5-3.5 3.5 1.57 3.5 3.5-1.57 3.5-3.5 3.5z"></path>
            </svg>
          </button> 
        </div>

          <main className="w-full max-w-4xl z-10 p-4 relative">
            <header className="relative flex flex-col items-center justify-center mb-16 select-none group">
                <div className="absolute -top-10 left-1/2 -translate-x-1/2 w-32 h-32 bg-purple-500/20 rounded-full blur-[80px] pointer-events-none opacity-0 group-hover:opacity-100 transition-opacity duration-700" />

                <h1 className={`relative z-10 font-black tracking-tighter uppercase text-6xl md:text-8xl mb-2 bg-clip-text text-transparent bg-gradient-to-r ${greetingGradient} drop-shadow-2xl`}>
                    {greeting}
                </h1>
                
                <div className="relative z-10 text-3xl md:text-5xl font-black text-white/90 tracking-widest mb-6 drop-shadow-lg font-mono variant-numeric-tabular">
                    {time.toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' })}
                </div>
                
                <div className="relative z-10 px-6 py-2 rounded-full border border-white/10 bg-white/5 backdrop-blur-md shadow-lg transition-all duration-300 hover:bg-white/10 hover:border-white/20 hover:scale-105 hover:shadow-purple-500/10 cursor-default">
                    <p className="text-[10px] md:text-xs text-gray-300 font-bold uppercase tracking-[0.3em] flex items-center gap-2">
                        {formattedDate}
                    </p>
                </div>
            </header>

            <div className="relative">
              <div className="grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-5">
                {visibleItems.map((item) => (
                  <LinkCardSite2 key={item.id} data={item} onToggleMode={toggleCardMode} />
                ))}
              </div>
            </div>
          </main>

          {isConfigOpen && activeItem && (
            <div className="fixed inset-0 bg-black/80 flex items-center justify-center z-[100] p-2">
                {/* WRAPPER FLEX PARA POSICIONAR BOTÕES LATERAIS */}
                <div className="relative flex flex-col md:flex-row items-start gap-4">
                  
                  {/* === A MODAL DE CONFIGURAÇÕES (Lado Esquerdo no desktop) === */}
                  <div className="config-modal rounded-xl w-full max-w-2xl flex flex-col max-h-[85vh] h-auto shadow-2xl overflow-hidden relative">
                    
                    {/* --- POP-UP DE CONFIRMAÇÃO (DELETAR LINK) --- */}
                    {showDeleteConfirm && (
                        <div className="absolute inset-0 bg-black/90 z-[60] flex flex-col items-center justify-center p-8 text-center animate-fade-in backdrop-blur-sm">
                            <div className="w-16 h-16 rounded-full bg-red-500/10 border border-red-500/20 flex items-center justify-center mb-4 animate-bounce">
                                <i className="ph-bold ph-trash text-3xl text-red-500"></i>
                            </div>
                            <h3 className="text-white font-black text-xl uppercase tracking-wider mb-2">Excluir Link</h3>
                            <p className="text-gray-400 text-sm max-w-xs mb-6 font-medium">
                                Você está prestes a remover <span className="text-white">"{activeItem.title}"</span><br/>Essa ação não pode ser desfeita
                            </p>
                            <div className="flex gap-3">
                                <button
                                    onClick={() => setShowDeleteConfirm(false)}
                                    className="px-5 py-2.5 rounded-lg bg-[#222] border border-[#333] text-gray-300 text-xs font-bold uppercase tracking-widest hover:bg-[#333] hover:text-white transition-all duration-200"
                                >
                                    Cancelar
                                </button>
                                <button
                                    onClick={() => {
                                        deleteItem(activeItem.id);
                                        setShowDeleteConfirm(false);
                                    }}
                                    className="px-5 py-2.5 rounded-lg bg-red-600 border border-red-500 text-white text-xs font-bold uppercase tracking-widest hover:bg-red-700 hover:shadow-lg hover:shadow-red-900/30 transition-all duration-200"
                                >
                                    Excluir Link
                                </button>
                            </div>
                        </div>
                    )}

                    {/* --- POP-UP DE CONFIRMAÇÃO (DELETAR SUBLISTA) --- */}
                    {showSublistDeleteConfirm && (
                        <div className="absolute inset-0 bg-black/90 z-[60] flex flex-col items-center justify-center p-8 text-center animate-fade-in backdrop-blur-sm">
                            <div className="w-16 h-16 rounded-full bg-indigo-500/10 border border-indigo-500/20 flex items-center justify-center mb-4 animate-bounce">
                                <i className="ph-bold ph-code text-3xl text-indigo-500"></i>
                            </div>
                            <h3 className="text-white font-black text-xl uppercase tracking-wider mb-2">Excluir Sublink</h3>
                            <p className="text-gray-400 text-sm max-w-xs mb-6 font-medium">
                                Você está prestes a excluir o Sublink de <span className="text-white">"{activeItem.title}"</span><br/>O link principal será mantido
                            </p>
                            <div className="flex gap-3">
                                <button
                                    onClick={() => setShowSublistDeleteConfirm(false)}
                                    className="px-5 py-2.5 rounded-lg bg-[#222] border border-[#333] text-gray-300 text-xs font-bold uppercase tracking-widest hover:bg-[#333] hover:text-white transition-all duration-200"
                                >
                                    Cancelar
                                </button>
                                <button
                                    onClick={() => {
                                        deleteSublist(activeItem.id);
                                        setShowSublistDeleteConfirm(false);
                                    }}
                                    className="px-5 py-2.5 rounded-lg bg-indigo-600 border border-indigo-500 text-white text-xs font-bold uppercase tracking-widest hover:bg-indigo-700 hover:shadow-lg hover:shadow-indigo-900/30 transition-all duration-200"
                                >
                                    Excluir Sublink
                                </button>
                            </div>
                        </div>
                    )}

                    {/* --- POP-UP DE CONFIRMAÇÃO (IMPORTAÇÃO CONCLUÍDA) --- */}
                    {showImportConfirm && (
                        <div className="absolute inset-0 bg-black/90 z-[60] flex flex-col items-center justify-center p-8 text-center animate-fade-in backdrop-blur-sm">
                            <div className="w-16 h-16 rounded-full bg-green-500/10 border border-green-500/20 flex items-center justify-center mb-4 animate-bounce">
                                <i className="ph-bold ph-check text-3xl text-green-500"></i>
                            </div>
                            <h3 className="text-white font-black text-xl uppercase tracking-wider mb-2">Importação Concluída</h3>
                            <p className="text-gray-400 text-sm max-w-xs mb-6 font-medium">
                                As configurações foram carregadas com sucesso - Clique em <span className="text-white">SALVAR</span> para aplicar
                            </p>
                            <button
                                onClick={() => setShowImportConfirm(false)}
                                className="px-5 py-2.5 rounded-lg bg-green-600 border border-green-500 text-white text-xs font-bold uppercase tracking-widest hover:bg-green-700 hover:shadow-lg hover:shadow-green-900/30 transition-all duration-200"
                            >
                                OK, Entendi
                            </button>
                        </div>
                    )}

                    {/* --- POP-UP DE CONFIRMAÇÃO (EXPORTAÇÃO) --- */}
                    {showExportConfirm && (
                        <div className="absolute inset-0 bg-black/90 z-[60] flex flex-col items-center justify-center p-8 text-center animate-fade-in backdrop-blur-sm">
                            <div className="w-16 h-16 rounded-full bg-blue-500/10 border border-blue-500/20 flex items-center justify-center mb-4 animate-bounce">
                                <i className="ph-bold ph-download-simple text-3xl text-blue-500"></i>
                            </div>
                            <h3 className="text-white font-black text-xl uppercase tracking-wider mb-2">Exportar Definições</h3>
                            <p className="text-gray-400 text-sm max-w-xs mb-6 font-medium">
                                Você poderá importá-lo depois para restaurar as configurações de seus links
                            </p>
                            <div className="flex gap-3">
                                <button
                                    onClick={() => setShowExportConfirm(false)}
                                    className="px-5 py-2.5 rounded-lg bg-[#222] border border-[#333] text-gray-300 text-xs font-bold uppercase tracking-widest hover:bg-[#333] hover:text-white transition-all duration-200"
                                >
                                    Cancelar
                                </button>
                                <button
                                    onClick={executeExport}
                                    className="px-5 py-2.5 rounded-lg bg-blue-600 border border-blue-500 text-white text-xs font-bold uppercase tracking-widest hover:bg-blue-700 hover:shadow-lg hover:shadow-blue-900/30 transition-all duration-200"
                                >
                                    Confirmar Exportação
                                </button>
                            </div>
                        </div>
                    )}

                    {/* --- HEADER DA MODAL (TABS) --- */}
                    <div className="flex-none flex items-center bg-[#050505] border-b border-[#1a1a1a] h-12 pr-2">
                      <div className="flex-1 flex items-center gap-1 overflow-x-auto custom-scrollbar horizontal-scrollbar h-full px-2">
                        {tempItems.map((item) => (
                          <button
                            key={item.id}
                            draggable
                            onDragStart={() => setDraggedId(item.id)}
                            onDragOver={(e) => {
                              e.preventDefault();
                              e.currentTarget.classList.add('bg-white/10');
                            }}
                            onDragLeave={(e) => {
                              e.currentTarget.classList.remove('bg-white/10');
                            }}
                            onDrop={() => {
                              moveItem(draggedId, item.id);
                              setDraggedId(null);
                            }}
                            onDragEnd={() => setDraggedId(null)}
                            onClick={() => {
                                setActiveTabId(item.id);
                                setEditingSublist(false);
                            }}
                            className={`flex-shrink-0 flex items-center gap-2 px-4 h-9 rounded-md transition-all duration-200 cursor-grab active:cursor-grabbing ${
                              activeTabId === item.id
                                ? 'bg-white/15 text-white shadow-lg'
                                : 'text-gray-500 hover:bg-white/5 hover:text-gray-300'
                            }`}
                          >
                            <i className={`ph-bold ${item.icon} text-sm`}></i>
                            <span className="text-[10px] font-black uppercase tracking-wider whitespace-nowrap">
                              {item.title}
                            </span>
                            {/* AVISO DE SUBLISTA (Ícone discreto) */}
                            {item.sublist && (
                                 <i className="ph-bold ph-code text-[10px] text-indigo-500/70 ml-1.5"></i>
                            )}
                          </button>
                        ))}
                      </div>
                    </div>

                    {/* --- CONTEÚDO DA MODAL --- */}
                    <div className="flex-1 overflow-y-auto custom-scrollbar bg-[#0a0a0a]">
                      <div className="flex flex-col">
                        
                        {/* Barra de Título e Ações */}
                        <div className={`px-5 py-3 flex items-center justify-between border-b border-[#1a1a1a] transition-colors duration-300 ${editingSublist ? 'bg-indigo-900/10' : 'bg-[#0c0c0c]'}`}>
                          <div className="flex items-center gap-3">
                            <div className={`w-8 h-8 rounded-lg ${editingData.color === 'random' ? 'bg-gradient-to-tr from-red-500 via-yellow-500 via-green-500 via-blue-500 to-purple-500' : editingData.color} flex items-center justify-center bg-opacity-20`}>
                              <i className={`ph-bold ${editingData.icon} text-base text-white`}></i>
                            </div>
                            <div className="flex flex-col leading-none">
                              <h3 className="text-[11px] font-black text-white uppercase tracking-widest">{editingData.title}</h3>
                              <span className={`text-[8px] font-bold uppercase mt-1 flex items-center gap-1 ${editingSublist ? 'text-indigo-400' : 'text-gray-600'}`}>
                                 {editingSublist ? (
                                   <>
                                         <i className="ph-bold ph-code"></i>
                                         Editando Sublink
                                   </>
                                 ) : 'Editando Link Principal'}
                              </span>
                            </div>
                          </div>

                          <div className="flex items-center gap-2">
                            {/* Botão SUBLISTA / VOLTAR (ALTURA FIXADA) */}
                            <button 
                              onClick={() => toggleSublistCreation(activeItem.id)} 
                              className={`flex items-center justify-center gap-2 px-3 h-8 rounded-lg transition-all duration-300 border group ${sublistBtn.color}`}
                              
                            >
                              <i className={`ph-bold ${sublistBtn.icon} text-lg`}></i>
                              <span className="text-[10px] font-bold uppercase tracking-wider">{sublistBtn.text}</span>
                            </button>

                            {/* Botão LIXEIRA INTELIGENTE (ALTURA FIXADA + HOVER QUADRADO) */}
                            <button 
                              onClick={() => editingSublist ? setShowSublistDeleteConfirm(true) : setShowDeleteConfirm(true)} 
                              className="text-gray-600 hover:text-red-500 flex items-center justify-center transition-all duration-300 w-8 h-8 rounded-lg hover:bg-red-500/10 group hover:scale-110 active:scale-95"
                            >
                              <i className="ph-bold ph-trash text-lg"></i>
                            </button>
                          </div>
                        </div>

                        {/* Formulário de Edição */}
                        <div className="p-5 space-y-3 max-h-[400px] overflow-y-auto custom-scrollbar">
                          
                          {/* Aviso visual de conexão */}
                          {editingSublist && (
                              <div className="flex items-center gap-2 p-2 rounded bg-indigo-500/10 border border-indigo-500/20 mb-2">
                                  <i className="ph-fill ph-plugs-connected text-indigo-400"></i>
                                  <span className="text-[10px] text-indigo-200">
                                      Esse Sublink está conectada a <strong>{activeItem.title}</strong>
                                  </span>
                              </div>
                          )}

                          <div className="grid grid-cols-2 gap-3">
                            <div className="space-y-1">
                              <label className="text-[9px] font-black text-gray-500 uppercase tracking-widest ml-1">Título {editingSublist ? '(Sub)' : ''}</label>
                              <input
                                type="text"
                                value={editingData.title || ''}
                                onChange={(e) => updateItem(activeItem.id, 'title', e.target.value)}
                                className="w-full bg-[#141414] border border-[#2a2a2a] rounded-lg px-3 py-2 text-xs text-white outline-none focus:border-white/20"
                                placeholder={editingSublist ? "Ex: Minha Lista VIP" : "Título do Site"}
                              />
                            </div>
                            <div className="space-y-1">
                              <label className="text-[9px] font-black text-gray-500 uppercase tracking-widest ml-1">Subtítulo</label>
                              <input
                                type="text"
                                value={editingData.subtitle || ''}
                                onChange={(e) => updateItem(activeItem.id, 'subtitle', e.target.value)}
                                className="w-full bg-[#141414] border border-[#2a2a2a] rounded-lg px-3 py-2 text-xs text-white outline-none focus:border-white/20"
                              />
                            </div>
                          </div>

                          <div className="space-y-1">
                            <label className="text-[9px] font-black text-gray-500 uppercase tracking-widest ml-1">Classe do Ícone (Phosphor)</label>
                            <input
                              type="text"
                              value={editingData.icon || ''}
                              onChange={(e) => updateItem(activeItem.id, 'icon', e.target.value)}
                              className="w-full bg-[#141414] border border-[#2a2a2a] rounded-lg px-3 py-2 text-xs text-white outline-none focus:border-white/20 font-mono"
                            />
                          </div>
                          <div className="space-y-1">
                            <label className="text-[9px] font-black text-gray-500 uppercase tracking-widest ml-1">Link de Destino (URL) {editingSublist ? '(Alternativo)' : ''}</label>
                            <input
                              type="text"
                              value={editingData.url || ''}
                              onChange={(e) => updateItem(activeItem.id, 'url', e.target.value)}
                              className="w-full bg-[#141414] border border-[#2a2a2a] rounded-lg px-3 py-2 text-xs text-gray-400 outline-none focus:border-white/20"
                            />
                          </div>

                          <div className="pt-1">
                              <button
                                onClick={() => setShowAdvancedSettings(!showAdvancedSettings)}
                                className="flex items-center gap-2 text-[10px] font-black text-gray-500 uppercase tracking-widest hover:text-white transition-colors"
                              >
                                <i className={`ph-bold ${showAdvancedSettings ? 'ph-caret-up' : 'ph-caret-down'} transition-transform duration-300 ${showAdvancedSettings ? 'rotate-180' : ''}`}></i>
                                {showAdvancedSettings ? 'Menos configurações' : 'Mais configurações'}
                              </button>
                          </div>

                          {/* --- CONFIGURAÇÕES AVANÇADAS --- */}
                          <div className={`advanced-settings-enter ${showAdvancedSettings ? 'show' : ''}`}>
                              <div className="space-y-4 pt-2">
                                  
                                 <div className="space-y-1">
                                   <label className="text-[9px] font-black text-gray-500 uppercase tracking-widest ml-1">Cor do Tema</label>
                                     <div className="bg-[#141414] border border-[#2a2a2a] rounded-lg p-3">
                                       <div className="grid grid-cols-7 gap-2">
                                         {AVAILABLE_COLORS.map((colorClass) => {
                                           const isExclusive = colorClass !== 'random';
                                           
                                           // Lógica de exclusão de cores para sublistas
                                           let owner = null;
                                           if (isExclusive) {
                                               if (editingSublist) {
                                                   // Verifica se alguma OUTRA sublista já usa essa cor
                                                   owner = tempItems.find(i => 
                                                       i.id !== activeItem.id && // Não é o item atual
                                                       i.sublist && // Tem sublista
                                                       i.sublist.color === colorClass // A cor é igual
                                                   );
                                               } else {
                                                   // Verifica listas principais
                                                   owner = tempItems.find(i => i.color === colorClass && i.id !== activeItem.id);
                                               }
                                           }

                                           const isDisabled = !!owner;

                                           return (
                                             <button
                                               key={colorClass}
                                               onClick={() => !isDisabled && updateItem(activeItem.id, 'color', colorClass)}
                                               disabled={isDisabled}
                                               
                                               className={`h-6 rounded-md relative flex items-center justify-center transition-all duration-200 ${
                                                 editingData.color === colorClass
                                                   ? 'ring-2 ring-white scale-105 shadow-lg opacity-100'
                                                   : isDisabled 
                                                     ? 'opacity-50 cursor-not-allowed border border-white/10' 
                                                     : 'opacity-20 hover:opacity-100 hover:scale-110 border border-transparent'
                                               }`}
                                             >
                                               <div className={`w-full h-full rounded-md shadow-sm ${colorClass === 'random' ? 'bg-gradient-to-tr from-red-500 via-yellow-500 via-green-500 via-blue-500 to-purple-500' : colorClass}`}></div>
                                               
                                               {isDisabled && (
                                                   <div className="absolute inset-0 flex items-center justify-center bg-black/40 rounded-md">
                                                         <i className={`ph-bold ${owner.icon} text-white text-xs`}></i>
                                                   </div>
                                               )}
                                             </button>
                                           );
                                         })}
                                       </div>
                                     </div>
                                  </div>

                                  <div className="grid grid-cols-2 gap-3">
                                     <div className="space-y-1">
                                         <label className="text-[9px] font-black text-gray-500 uppercase tracking-widest ml-1">Status</label>
                                         <div className="bg-[#141414] border border-[#2a2a2a] rounded-lg px-3 py-2 flex items-center justify-between h-[38px]">
                                             <span className={`text-[10px] font-bold ${editingData.enabled ? 'text-green-500' : 'text-red-500'}`}>
                                                 {editingData.enabled ? 'ATIVO' : 'INATIVO'}
                                             </span>
                                             <ToggleSwitch 
                                                 checked={editingData.enabled} 
                                                 onChange={(val) => updateItem(activeItem.id, 'enabled', val)} 
                                             />
                                         </div>
                                     </div>
                                     <div className="space-y-1">
                                         <label className="text-[9px] font-black text-gray-500 uppercase tracking-widest ml-1">Modo de Abertura</label>
                                         <div className="bg-[#141414] border border-[#2a2a2a] rounded-lg px-3 py-2 flex items-center justify-between h-[38px]">
                                             <span className="text-[10px] font-bold text-gray-300">
                                                 {editingData.openNewTab !== false ? 'NOVA ABA' : 'MESMA ABA'}
                                             </span>
                                             <ToggleSwitch 
                                                 checked={editingData.openNewTab !== false} 
                                                 onChange={(val) => updateItem(activeItem.id, 'openNewTab', val)} 
                                             />
                                         </div>
                                     </div>
                                  </div>
                              </div>
                          </div>
                          
                          {/* REMOVIDO: Seção "Gerenciar Dados" (Exportar/Importar) pois agora está na barra lateral */}

                        </div>
                      </div>
                    </div>

                    <div className="p-3 bg-[#050505] border-t border-[#1a1a1a] flex justify-end items-center gap-3">
                        <button 
                          onClick={() => setIsConfigOpen(false)}
                          className="text-[10px] font-black text-gray-600 hover:text-white uppercase tracking-widest px-4 py-2 transition-all duration-300 rounded hover:bg-white/5"
                        >
                          Descartar
                        </button>
                        <button
                          onClick={saveConfig}
                          className="bg-white/5 text-gray-500 border border-white/5 px-6 py-2 rounded-lg text-[10px] font-black uppercase tracking-widest active:scale-95 transition-all duration-300 hover:bg-white/10 hover:text-white hover:shadow-lg"
                        >
                          SALVAR
                        </button>
                    </div>
                  </div>

                  {/* === BARRA LATERAL DE AÇÕES (Lado Direito - VISUAL NOVO) === */}
                  <div className="flex flex-row md:flex-col gap-3 z-50">
                    
                    {/* Botão Adicionar Novo Link (+) */}
                    <button
                        onClick={addNewLink}
                        className="group w-12 h-12 rounded-xl bg-[#121212] border border-[#333] hover:bg-[#222] hover:border-[#444] hover:shadow-lg hover:shadow-black/50 hover:scale-110 active:scale-95 transition-all duration-300 flex items-center justify-center text-white side-action-btn"
                        style={{ animationDelay: '0.1s' }}
                    >
                        <i className="ph-bold ph-plus text-xl text-green-500 transition-all duration-300 group-hover:drop-shadow-[0_0_8px_rgba(34,197,94,0.6)] group-hover:scale-110"></i>
                    </button>

                    {/* Botão Exportar */}
                    <button
                        onClick={() => setShowExportConfirm(true)}
                        className="group w-12 h-12 rounded-xl bg-[#121212] border border-[#333] hover:bg-[#222] hover:border-[#444] hover:shadow-lg hover:shadow-black/50 hover:scale-110 active:scale-95 transition-all duration-300 flex items-center justify-center text-white side-action-btn"
                        style={{ animationDelay: '0.2s' }}
                    >
                        <i className="ph-bold ph-download-simple text-xl text-blue-500 transition-all duration-300 group-hover:drop-shadow-[0_0_8px_rgba(59,130,246,0.6)] group-hover:scale-110"></i>
                    </button>

                    {/* Botão Importar */}
                    <label 
                        className="group w-12 h-12 rounded-xl bg-[#121212] border border-[#333] hover:bg-[#222] hover:border-[#444] hover:shadow-lg hover:shadow-black/50 hover:scale-110 active:scale-95 transition-all duration-300 flex items-center justify-center text-white cursor-pointer side-action-btn"
                        style={{ animationDelay: '0.3s' }}
                    >
                        <i className="ph-bold ph-upload-simple text-xl text-orange-500 transition-all duration-300 group-hover:drop-shadow-[0_0_8px_rgba(249,115,22,0.6)] group-hover:scale-110"></i>
                        <input
                            type="file"
                            accept=".json"
                            className="hidden"
                            onChange={handleImport}
                        />
                    </label>

                  </div>

                </div>
            </div>
          )}
        </div>
      );
    };

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
  </script>
</body>
</html>
